{
  "metadata": {
    "plugin": [
      "sqlite.py"
    ]
  },
  "mappings": {
    "urls": {
      "event_code": "url",
      "agent_type": "chromium",
      "fields": {
        "url": {
          "ecs": [
            "url.full",
            "url.original"
          ]
        },
        "last_visit_time": {
          "ecs": "@timestamp",
          "is_timestamp_chrome": true
        }
      }
    },
    "downloads": {
      "event_code": "download",
      "agent_type": "chromium",
      "fields": {
        "site_url": {
          "ecs": [
            "url.full",
            "url.original"
          ]
        },
        "start_time": {
          "ecs": "@timestamp",
          "is_timestamp_chrome": true
        },
        "end_time": {
          "is_timestamp_chrome": true,
          "ecs": "download.end_time"
        },
        "hash": {
          "ecs": "file.hash"
        },
        "referrer": {
          "ecs": "http.request.referrer"
        },
        "mime_type": {
          "ecs": "http.request.mime_type"
        },
        "target_path": {
          "ecs": "file.target_path"
        },
        "current_path": {
          "ecs": "file.path"
        },
        "total_bytes": {
          "ecs": [
            "http.request.body.bytes",
            "file.size"
          ]
        },
        "http_method": {
          "ecs": "http.request.method"
        }
      }
    },
    "visits": {
      "agent_type": "chromium",
      "event_code": "visit",
      "ignore": [
        "last_visit_time"
      ],
      "fields": {
        "visit_time": {
          "ecs": "@timestamp",
          "is_timestamp_chrome": true
        },
        "url": {
          "ecs": "url.full"
        },
        "title": {
          "ecs": "title"
        },
        "external_referrer_url": {
          "ecs": "http.request.referrer"
        }
      }
    }
  }
}